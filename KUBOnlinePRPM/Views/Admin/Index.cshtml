@model KUBOnlinePRPM.Models.NotiModel

@using (Html.BeginForm("Index", "Admin", FormMethod.Post, new { @id = "GenerateExcelPage", @class = "container-fluid g-mb-40" }))
{
    <div class="row g-bg-white g-pa-20">
        <div class="col-md-12">
            <div class="media-body align-self-center text-left g-mb-30">
                <h3 class="g-font-weight-400 g-font-size-20 g-color-black">Generate Excel For Navision 2017</h3>
            </div>
        </div>
        <div class="container-fluid-v3 col-xs-12 g-mb-30 g-mt-10">
            <div class="row g-mb-20">
                <div class="col-md-2 col-sm-2 formfield">
                    <span>Start Date</span>
                </div>
                <div class="d-flex col-md-4 col-sm-4">
                    @Html.TextBoxFor(m => m.StartDate, new { @id = "StartDate", @class = "form-control form-control-md g-brd-gray-light-v7 g-brd-gray-light-v3--focus g-rounded-20 g-px-14 g-py-10", @type = "date" })
                </div>
            </div>
            <div class="row g-mb-20">
                <div class="col-md-2 col-sm-2 formfield">
                    <span>End Date</span>
                </div>
                <div class="d-flex col-md-4 col-sm-4">
                    @Html.TextBoxFor(m => m.EndDate, new { @id = "EndDate", @class = "form-control form-control-md g-brd-gray-light-v7 g-brd-gray-light-v3--focus g-rounded-20 g-px-14 g-py-10", @type = "date" })
                </div>
            </div>
            @*<input id="@DateRequired" class="form-control rounded-0 form-control-md" value="@item.DateRequired.ToString("yyyy-MM-dd")" name="DateRequired" type="date">*@
            <div class="row g-mb-20">
                <div class="col-md-2 col-sm-2 formfield">
                    <span>Generated File Location</span>
                </div>
                <div class="d-flex col-md-4 col-sm-4">
                    @Html.TextBoxFor(m => m.ExtractFileLocation, new { @id = "ExtractFileLocation", @class = "form-control form-control-md g-brd-gray-light-v7 g-brd-gray-light-v3--focus g-rounded-20 g-px-14 g-py-10", @type = "text" })
                </div>
            </div>
            <div class="row">
                @*<div class="col-md-9 col-sm-8"></div>*@
                <div class="col-md-4 offset-md-2 col-sm-4 offset-sm-8">
                    <div class="media float-md-right">
                        <div class="d-flex u-main-nav--push-right text-right">
                            <a id="GenerateExcelFile" class="UploadFile btn btn-md text-white u-btn-blue g-mr-5 g-mb-15">GENERATE EXCEL</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    @*<div class="row g-bg-white g-pa-20">
            <div class="col-md-12">
                <div class="media-body align-self-center text-left g-mb-30">
                    <h3 class="g-font-weight-400 g-font-size-20 g-color-black">Excel History Table</h3>
                </div>
            </div>
            <div class="container-fluid-v3 col-xs-12 g-mb-30 g-mt-10">
                <table id="ExcelHistoryTable" class="table table-striped table-bordered dt-responsive table-hover" style="width:100%">
                    <thead>
                        <tr>
                            <th class="all">
                                <div class="media">
                                    <div class="d-flex align-self-center">Admin Involved</div>
                                </div>
                            </th>
                            <th class="desktop">
                                <div class="media">
                                    <div class="d-flex align-self-center">Message</div>
                                </div>
                            </th>
                            <th class="desktop">
                                <div class="media">
                                    <div class="d-flex align-self-center">Generated Date</div>
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @{
                            foreach (var item in Model.NotiListObject)
                            {
                                <tr>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.FromFullName)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Message)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.MsgDate)
                                    </td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>
        </div>*@
}

    <div id="UploadProgressModal" class="text-left g-max-width-600 g-bg-white g-overflow-y-auto g-pa-20" style="display: none;">
        <button type="button" class="close" onclick="Custombox.modal.close();">
            <i class="hs-icon hs-icon-close"></i>
        </button>
        <div class="row" id="uploadProgress">
            <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">
                0% Complete
            </div>
        </div>
    </div>

    @section scripts {
        <script type="text/javascript">
        var ExcelHistoryTable;
        var URLAdmin = "@Url.Action("Index", "Admin")";
        </script>
        <script src="~/Scripts/ExcelGenerator.js"></script>
    }